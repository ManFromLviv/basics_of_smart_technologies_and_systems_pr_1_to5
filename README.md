# Практична робота № 5, Вальчевський П., ОІ-21сп

## Бізнес-цілі:
### Поліпшення класифікації пінгвінів:
#### Ціль моделювання: Розробка моделі машинного навчання, що точно класифікує пінгвінів за видами на основі фізичних характеристик.
#### Критерії успіху: 
- Алгоритм повинен визначити фізичні характеристики (гендерні особливості, маса і т. д.) на основі повноти даних про кожного пінгвіна.
- Визначення відповідної класифікації пінгвінів.
- Класифікація пінгвінів не суперечать даним, які залучені під час її створення.


### Поліпшити розуміння різноманіття та розподілу цих видів у регіоні:
#### Ціль моделювання: Аналіз результатів класифікації для виявлення ключових видів пінгвінів та їх розподілу в регіоні.
#### Критерії успіху: 
- Результати класифікації пінгвінів мають надати дані про різноманіття пінгвінів у регіоні. 
- На основі точності даних будуть формуватися звіти, що будуть сумувати розуміння про різноманіття пінгвінів.


### Підвищення ефективності досліджень:
#### Ціль моделювання: Забезпечення рішення для науковців, що полегшить процес ідентифікації та обліку пінгвінів.
#### Критерії успіху: 
- Науковці розуміють, що за дані їм представлені та можуть з ними взаємодіяти для подальших досліджень.
- Результати досліджень повинні надавати картину про стан пінгвінів та розуміння їх екологічного статусу.
- Виконані дослідження будуть основою для подальших досліджень, уявлення про повну картину щодо пінгвінів у регіоні.

## Опис проекту
Цей проект включає підготовку даних (лише їх кодування, бо обробка відсутніх значень відбулася в минулих практичних роботах) та розділення на тренувальний та тестовий набори даних. Це потрібно для тренування та подальшого передбачення моделей.
Я вибрав такі моделі `RandomForestClassifier, LogisticRegression, SVC` та здійснив їх налаштування (вибрав гіперпараметри та здійсний їх оптимізацію за допомогою RandomizedSearchCV).
Також цей проект має графічний інтерфейс для якого використовується бібліотека `tkinter`.

## Структура проекту
- `.venv` - папка віртуального середовища проекту, де зберігаються ізольовані бібліотеки та залежності (автоматично створюється у середовищі). 
- `src/` - папка що містить усі виконавчі скрипти (або .ipynb, .pkl).
  - `src/models` - містить усі збережені моделі, після виконання `train_models.py` (усі файли .pkl).
  - `src/practicals` - містить файли ПР № 1, 2, 3, 4 (усі файли .ipynb).
  - `split_data.py` - розподіл даних на тренувальний і тестовий набори та збереження у окремі файли у каталозі `data` (є однойменною функцією).
  - `train_models.py` - налаштування і тренування моделей на тренувальних даних (є однойменною функцією).
  - `predict_models.py` - передбачення на основі тестових наборів даних і вивід метрик оцінювання за допомогою методу `sklearn.metrics.classification_report` та збережння передбачених даних (cvs) і звіту метрик даних (txt) у каталог `data\prediction` (є однойменною функцією).
- `data/` = папка, що містить набори даних (оригінальний, тренувальний, тестовий) та історію передбачень у папці `predictions` (сам файл .cvs та звіт метрик .txt).
  - `data/predictions` - папка історії передбачень усіх моделей та звіт метрик до них (наприклад: random_search_log_reg_predictions_2024-10-28_02-40-31.csv або .txt).
  - `variant_2_new.cvs` - оригінальний набір даних.
  - `train_split.cvs` - тренувальний набір даних.
  - `new_input.cvs` - тестовий набір даних.
- `README.md` - документація проекту.
- `requirements.txt` - перелік залежностей для відтворення середовища (згенеровано через `Tools -> Sync Python Requirements`).
- `main.py` - файл запуску програми, він реалізує графічний інтерфейс та послідовне виконання файлів `split_data.py, train_models.py, predict_models.py`.

## Інструкція користувачеві
- Користувач запускає програму через середовище PyCharm.
- Далі користувач бачить перед собою вікно програми, де є поле вводу, поле виводу, 3 кнопки і повзунки для налаштування моделей:
  - поле вводу - містить дефолтний шлях до даних `data/variant_2_new.csv`, при потребі його можна буде змінити.
  - поле виводу - там буде виведена інформація про результати виконання програми або помилку у разі, якщо шлях до даних неправильний.
  - кнопка "Почати!" - запускає алгоритм виконання програми (послідовне виконання файлів split_data.py, train_models.py, predict_models.py). Результат після виконання буде показано у полі виводу.
  - кнопка "Відкрити папку з даними" - відкриває папку `data` проекту у Провіднику.
  - кнопка "Відкрити папку з ресурсами" - відкриває папку `src` проекту у Провіднику.
- Користувач може використати дефолтний шлях або ввести свій. Якщо користувач ввів правильно усі дані, то він у полі виводу отримає детальний результат про виконання програми. У протилежному випадку буде інформація про помилку.
- Користувач може відкрити папки з даними чи ресурсами натиснувши на відповідні кнопки.
- Користувач рухає повзунки для налаштувань усіх моделей та обирає оптимальний варіант.

## Установка
1. Клонування репозиторію:
```bash
   git clone https://github.com/ManFromLviv/basics_of_smart_technologies_and_systems_pr_1_to5
   ```
2. Перехід до папки проекту:
```bash
   cd <назви папки, де скопійовано проект>
```
3. Створення віртуально середовища:
```bash
   python -m venv .venv
```
4. Активування віртуального середовища:
```bash
   .venv\Scripts\activate
```
5. Встановлення залежностей:
```bash
   pip install -r requirements.txt
```
6. Запуск програми:
```bash
   python main.py
```

## Висновки
У процесі виконання даної практичної роботи я зробив щось подібне до ML проекту (описав у розділі `Опис проекту`) та передбачив використання графічного інтерфейсу.
Було визначену таку точність моделей (через найменші значення повзунків - чим вищі значення тим більша точність):
- `RandomForestClassifier` - 65
- `LogisticRegression` - 67
- `SVC`- 57
Найбільш складнішим етапом за всі ПР було обробка значень (пропущених, аномальних) та налаштування і оптимізація гіперпараметрів.
Сподобалось усе.
Загальні враження позитивні - на лекціях реально було цікаво слухати і я інколи шкодував, що деякі з них пропускав.
Виконуючи ПР я навчився:
- ПР 1 - визначати бізнес-цілі та цілі моделювання. Формувати критерії успіху до них. Також, зробив аналіз даних для свого варіанту.
- ПР 2 - я обробляв дані, а саме відстутні дані, кодував та їх масштабував.
- ПР 3 - проводив для моделей тренування та валідацію. Обрав ще метрики оцінки результатів.
- ПР 4 - проводив налаштування моделі (вибір та оптимізація гіперпараметрів) та була робота з незбалансованими класами.
- ПР 5 - опис вище.